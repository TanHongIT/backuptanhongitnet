self.System=self.System||(()=>{const e={},t={},n=e=>e.replace(/^.\/(\w+)-[a-f0-9]{8,}.js$/,"./$1.js"),a=window.customElements?Promise.resolve():new Promise((e,t)=>{const n=document.getElementById("js-conditional-compat");if(!(n instanceof HTMLScriptElement))return t(new Error("unable to load compat.js"));const a=setTimeout(()=>{t(new Error("timed out loading compat.js"))},1e4);n.onload=()=>{clearTimeout(a),e()},n.onerror=()=>{clearTimeout(a),t(new Error("network error loading compat.js"))},n.src=n.getAttribute("data-src")||"",n.removeAttribute("data-src")}),s={register(r,o){const i=n(`./${((document.currentScript||{}).src||"").split("?").shift().split("/").pop()}`),l={},c=o((e,t)=>t?l[e]=t:Object.assign(l,e),s),m=r.map((e,t)=>s.import(n(e)).then(c.setters[t]));m.unshift(a),e[i]=Promise.all(m).then(()=>(c.execute(),l)).catch(e=>{throw e.message=`evaluating module ${i}: ${e.message}`,e}),t[i]&&(t[i](e[i]),delete t[i])},import:n=>e[n]||(e[n]=new Promise((e,a)=>{const s=setTimeout(()=>{a(new Error(`could not resolve ${n}`))},1e4);t[n]=t=>{clearTimeout(s),e(t)}}))};return s})(),System.register(["./frameworks.js","./vendor.js"],(function(){"use strict";var e,t,n,a,s,r,o,i,l,c,m,d;return{setters:[function(m){e=m.e,t=m.j,n=m.az,a=m.c,s=m.q,r=m.g,o=m.r,i=m.a4,l=m.a,c=m.d},function(e){m=e.o,d=e.a}],execute:function(){function p(e){const t=a(e,".js-marketplace-listing-form-container");s(t,".js-marketplace-listing-error-container").classList.remove("visible")}function u(e,t){const n=a(e,".js-marketplace-listing-form-container"),r=s(n,".js-marketplace-listing-error-container");r.classList.add("visible"),s(r,".js-marketplace-listing-error").textContent=t}function f(e){const t=e.querySelector(".js-marketplace-listing-save-notice");t&&(t.classList.add("visible"),setTimeout(()=>t.classList.remove("visible"),1500))}function g(e,t){const n=a(e,".js-marketplace-listing-form-container").querySelectorAll(".js-marketplace-listing-bgcolor");for(const a of n)a instanceof HTMLElement&&(a.style.backgroundColor=`#${t}`)}function j(e){const t=document.querySelector(".js-hero-listing-container .js-hero-listing-bgcolor");t instanceof HTMLElement&&(t.style.backgroundColor=`#${e}`)}function k(e,t,n){if(!(n instanceof HTMLElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:140");const r=a(n,".js-listing-characters-remaining-container"),o=s(r,".js-listing-characters-remaining"),l=String(o.getAttribute("data-suffix")),c=t-i(e);o.textContent=`${c} ${l}`,o.classList.toggle("text-red",c<=5)}function h(e){const t=e.item,n=s(t,".js-marketplace-listing-screenshot-resequence-form",HTMLFormElement),a=n.elements.namedItem("marketplace_listing_screenshot[previousScreenshotId]");if(!(a instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:309");const i=t.previousElementSibling;i instanceof HTMLElement?a.value=r(i,"data-screenshot-id"):a.value="",o(n)}function L(e){return["FLAT_RATE","PER_UNIT"].includes(e)}function v(e){return"PER_UNIT"===e}function E(e,t){for(const n of e)n.disabled=!t}function T(e){const t=document.querySelectorAll(".js-discounted-pricing");if(t.length>0){const n=e.hasAttribute("data-discounts-enabled"),a=document.querySelectorAll(".js-original-pricing");for(const e of t)e instanceof HTMLElement&&(e.hidden=!n);for(const e of a)e instanceof HTMLElement&&(e.hidden=n)}}async function w(e){const t=e.target;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/order.js:16");const n=parseInt(t.value,10).toFixed(),a=r(t,"data-url"),o=new URL(a,window.location.origin),i=new URLSearchParams(o.search.slice(1));i.set("quantity",n),o.search=i.toString();const l=await c(document,o.toString()),m=s(document,".js-marketplace-order-preview");m.innerHTML="",m.appendChild(l)}e(".js-marketplace-short-description-field",(function(e){const t=e.target;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:154");const n=a(t,".form-group");t.validity.patternMismatch?n.classList.add("errored"):n.classList.remove("errored")})),m("click",".js-marketplace-error-dismiss",(function(e){p(e.currentTarget)})),m("change",".js-marketplace-listing-light-text",(function(e){const t=e.target;if(!(t instanceof HTMLSelectElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:170");!function(e){const t=document.querySelector(".js-hero-listing-name");t&&("true"===e?(t.classList.add("text-white"),t.classList.remove("text-gray-dark")):(t.classList.remove("text-white"),t.classList.add("text-gray-dark")))}(t.value)})),m("change",".js-marketplace-listing-logo-background-color",(function(e){const t=e.target;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:176");g(a(t,"form",HTMLFormElement),t.value),j(t.value)})),t(".js-marketplace-listing-form",(async function(e,t){let n;p(e);try{n=await t.json()}catch(a){if(!a.response)throw a;return void u(e,a.response.json.error)}if(n.json.path){const e=window.location.pathname,t=n.json.path;if(e!==t)return void(window.location.href=t)}n.json.bgcolor&&(g(e,n.json.bgcolor),j(n.json.bgcolor)),n.json.short_description&&function(e){const t=document.querySelector(".js-hero-listing-description");t&&(t.textContent=e)}(n.json.short_description),f(e)})),t(".js-marketplace-listing-screenshot-update-form",(async function(e,t){try{await t.text()}catch(o){return void function(e){const t=e.querySelector(".js-marketplace-listing-save-error");t&&(t.classList.add("visible"),setTimeout(()=>t.classList.remove("visible"),1500))}(e)}const n=s(e,".js-marketplace-listing-screenshot-caption-field",HTMLInputElement),a=s(e,".js-marketplace-listing-screenshot-caption-present"),r=s(e,".js-marketplace-listing-screenshot-caption-empty");a.textContent=n.value,n.value.trim().length<1?(a.classList.add("d-none"),r.classList.remove("d-none")):(a.classList.remove("d-none"),r.classList.add("d-none")),f(e)})),t(".js-marketplace-listing-screenshot-delete-form",(async function(e,t){p(e),s(e,".js-marketplace-listing-screenshot-delete-button",HTMLButtonElement).disabled=!0;try{await t.text()}catch(n){if(n.response){try{u(e,n.response.json.error)}catch(r){throw n}finally{s(e,".js-marketplace-listing-screenshot-delete-button",HTMLButtonElement).disabled=!1}return}throw n}a(e,".js-marketplace-listing-screenshot-container").remove()})),e("textarea.js-listing-characters-remaining-field",(function(e){const t=e.target;if(!(t instanceof HTMLTextAreaElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:273");const n=parseInt(t.getAttribute("data-character-limit")||"",10);k(t.value,n,t)})),e("input.js-listing-characters-remaining-field",(function(e){const t=e.target;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit.js:281");const n=t.maxLength;k(t.value,n,t)})),m("details-menu-selected",".js-languages-menu",(function(e){const t=e.currentTarget.querySelectorAll('[role="menuitemcheckbox"][aria-checked="true"]');s(document,".js-language-selection").textContent=Array.from(t).map(e=>(e.textContent||"").trim()).sort().join(", ")}),{capture:!0}),d(".js-draggable-screenshots-container",(function(e){n.create(e,{animation:150,draggable:".js-draggable-screenshot",onUpdate:h})})),d(".js-listing-plan-option:checked",{constructor:HTMLInputElement,add(e){const t=e.value,n=a(e,".js-marketplace-edit-plan-editor"),r=l(n,".js-marketplace-plan-price-field-group",HTMLInputElement),o=l(n,".js-marketplace-plan-free-trial-field-group",HTMLInputElement),i=l(n,".js-marketplace-plan-unit-field-group",HTMLInputElement);!function(e){for(const t of document.querySelectorAll(".js-marketplace-plan-edit-unit"))t instanceof HTMLElement&&(t.hidden=!v(e));for(const t of document.querySelectorAll(".js-marketplace-plan-edit-price, .js-marketplace-plan-enable-free-trial"))t instanceof HTMLElement&&(t.hidden=!L(e))}(t),E(r,["FLAT_RATE","PER_UNIT"].includes(t)),E(o,L(t)),E(i,v(t)),s(n,".js-marketplace-plan-unit-name-field",HTMLInputElement).required=v(t)}}),m("click",".js-marketplace-plan-preview-toggle",(function(e){const t=a(e.currentTarget,".js-marketplace-edit-plan-container"),n=s(t,".js-marketplace-plan-editor-toggle"),r=s(t,".js-marketplace-edit-plan-editor"),o=s(t,".js-marketplace-edit-plan-preview");o.classList.contains("d-none")&&(e.currentTarget.classList.add("selected"),n.classList.remove("selected"),o.classList.remove("d-none"),r.classList.add("d-none"),function(e,t){const n=s(t,".js-marketplace-plan-name"),r=s(e,".js-marketplace-plan-name-field",HTMLInputElement).value;n.textContent=r;const o=s(t,".js-marketplace-free-trial-container"),i=s(t,".js-marketplace-no-trial-container"),c=s(t,".js-marketplace-direct-billing-container");s(e,".js-marketplace-free-trial-field",HTMLInputElement).checked?(o.classList.remove("d-none"),c.classList.add("d-none"),i.classList.add("d-none")):(i.classList.remove("d-none"),o.classList.add("d-none"),c.classList.add("d-none"));const m=s(e,".js-listing-plan-option:checked",HTMLInputElement).value,d=t.querySelectorAll(".js-marketplace-plan-unit-name"),p=s(t,".js-marketplace-plan-per-unit-info");if("PER_UNIT"===m){const t=s(e,".js-marketplace-plan-unit-name-field",HTMLInputElement).value;for(const e of d)e.textContent=t,e.classList.remove("d-none");p.classList.remove("d-none")}else{for(const e of d)e.classList.add("d-none");p.classList.add("d-none")}if("FREE"===m||"DIRECT_BILLING"===m){const e=t.querySelectorAll(".js-marketplace-plan-dollars-container");for(const t of e)t.classList.add("d-none")}else{const n=s(t,".js-marketplace-plan-monthly-dollars"),r=s(e,".js-marketplace-plan-monthly-price-field",HTMLInputElement).value;n.textContent=r,a(n,".js-marketplace-plan-dollars-container").classList.remove("d-none");const o=s(t,".js-marketplace-plan-yearly-dollars"),i=s(e,".js-marketplace-plan-yearly-price-field",HTMLInputElement).value;o.textContent=i,a(o,".js-marketplace-plan-dollars-container").classList.remove("d-none")}"DIRECT_BILLING"===m&&(i.classList.add("d-none"),o.classList.add("d-none"),c.classList.remove("d-none"));const u=s(t,".js-marketplace-plan-bullets");u.innerHTML="";const f=l(e,".js-marketplace-plan-bullet-field",HTMLInputElement),g=s(t,".js-marketplace-plan-bullet-template",HTMLTemplateElement);for(const a of f){const e=a.value;if(e.trim().length<1)continue;const t=g.content.cloneNode(!0);if(!(t instanceof DocumentFragment))return;s(t,".js-marketplace-plan-bullet").textContent=e,u.appendChild(t)}const j=s(t,".js-marketplace-plan-description"),k=s(e,".js-marketplace-plan-description-field",HTMLInputElement).value;j.textContent=k;const h=s(t,".js-marketplace-plan-for-account-type"),L=(s(e,".js-plan-for-account-type").textContent||"").toLowerCase();h.textContent=L}(r,o))})),m("click",".js-marketplace-plan-editor-toggle",(function(e){const t=a(e.currentTarget,".js-marketplace-edit-plan-container"),n=s(t,".js-marketplace-plan-preview-toggle"),r=s(t,".js-marketplace-edit-plan-editor"),o=s(t,".js-marketplace-edit-plan-preview");r.classList.contains("d-none")&&(e.currentTarget.classList.add("selected"),n.classList.remove("selected"),o.classList.add("d-none"),r.classList.remove("d-none"))})),m("change",".js-marketplace-plan-dollar-field",(function(e){const t=e.currentTarget;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/edit-pricing.js:238");a(t,".js-marketplace-plan-dollar-field-container").classList.toggle("is-errored",!t.checkValidity())})),d(".js-selected-account [data-menu-button]",T),m("details-menu-selected",".js-accounts-menu",e=>{if(!(e instanceof CustomEvent))throw new Error("invariant: app/assets/modules/github/marketplace/listing-page.js:17");T(e.detail.relatedTarget)},{capture:!0}),d(".js-marketplace-order-quantity",(function(e){e.addEventListener("input",w)})),m("change","input.js-grant-oap-checkbox",(function(e){const t=e.currentTarget;if(!(t instanceof HTMLInputElement))throw new Error("invariant: app/assets/modules/github/marketplace/order.js:36");const n=s(document,".js-marketplace-complete-order",HTMLButtonElement);n&&(n.disabled=!t.checked)})),m("click",".js-marketplace-complete-order",(function(e){e.preventDefault();const t=e.currentTarget;if(!(t instanceof HTMLButtonElement))throw new Error("invariant: app/assets/modules/github/marketplace/order.js:46");const n=t.form,a=document.querySelector(".js-marketplace-billing-modal");"true"===t.getAttribute("data-show-billing-modal")&&a?a.setAttribute("open","true"):n&&n.submit()}))}}}));
//# sourceMappingURL=marketplace-275b94fd.js.map
